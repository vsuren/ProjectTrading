2026-01-07 21:17:37 [INFO] ==== Labeled Features Started (run_id=LABEL_20260107_211737) ====
2026-01-07 21:17:37 [INFO] Dry-run mode: False, REBUILD_MODE: False
2026-01-07 21:17:37 [INFO] Creating SQLAlchemy engine for Labeled Features...
2026-01-07 21:17:38 [INFO] Connected to Azure SQL successfully.
2026-01-07 21:17:38 [INFO] No existing labeled rows found. Full backfill will be performed.
2026-01-07 21:17:38 [INFO] tblMergedFeatures columns: ['Symbol', 'PriceTimestamp', 'OpenPrice', 'HighPrice', 'LowPrice', 'ClosePrice', 'Volume', 'ADX_14', 'ATR_14', 'BBANDS_LOWER_20', 'BBANDS_MIDDLE_20', 'BBANDS_UPPER_20', 'BOLL_PCTB_20', 'BOLL_WIDTH_20', 'CCI_20', 'EMA_20', 'EMA_200', 'EMA_50', 'EMA_9', 'RSI_14', 'SMA_20', 'SMA_200', 'STOCH_D_14', 'STOCH_K_14', 'SUPERTREND_10', 'WILLIAMS_R_14', 'DayOfWeek', 'IsRegularSession', 'IsAfterHours', 'RunTimestamp', 'MergeRunId', 'SourceIndicatorCount', 'MissingIndicatorCount']
2026-01-07 21:17:48 [INFO] Loaded 284,325 rows from tblMergedFeatures (dynamic schema).
2026-01-07 21:17:48 [INFO] Loaded 31,049 rows from tblRawPrices.
2026-01-07 21:17:49 [INFO] Joined features with future close. Rows: 284,325.
2026-01-07 21:17:49 [INFO] Label computation completed in 0.34 seconds.
2026-01-07 21:17:49 [INFO] Prepared final DataFrame (dynamic): 284,325 rows, 46 columns.
2026-01-07 21:17:49 [INFO] Numeric columns detected for conversion/clipping: ['OpenPrice', 'HighPrice', 'LowPrice', 'Close_t', 'Volume', 'ADX_14', 'ATR_14', 'BBANDS_LOWER_20', 'BBANDS_MIDDLE_20', 'BBANDS_UPPER_20', 'BOLL_PCTB_20', 'BOLL_WIDTH_20', 'CCI_20', 'EMA_20', 'EMA_200', 'EMA_50', 'EMA_9', 'RSI_14', 'SMA_20', 'SMA_200', 'STOCH_D_14', 'STOCH_K_14', 'SUPERTREND_10', 'WILLIAMS_R_14', 'DayOfWeek', 'SourceIndicatorCount', 'MissingIndicatorCount', 'FutureClose_tN', 'Return_t_to_tN', 'Label', 'HorizonMinutes', 'IsTrainableRow', 'IsOutlier']
2026-01-07 21:18:53 [INFO] Writing 284,325 rows to tblLabeledFeatures in batches of 100...
2026-01-07 21:18:54 [INFO] Inserting batch 1 (100 rows)...
2026-01-07 21:18:54 [INFO] ===============================================
2026-01-07 21:18:54 [INFO] ROW INSERT FAILED
2026-01-07 21:18:54 [INFO] Failing row index in batch: 0
2026-01-07 21:18:54 [INFO] Row values: ('AAPL', Timestamp('2025-12-19 09:30:00'), 272.1449890136719, 272.5199890136719, 271.989990234375, 272.45001220703125, 14490528, None, 0.529998779296875, None, None, None, None, None, None, 272.45001220703125, 272.45001220703125, 272.45001220703125, 272.45001220703125, None, None, None, None, None, 270.6649932861328, None, 5, True, False, Timestamp('2026-01-03 23:52:44.693000'), 'MERGE_20260103_235236', 6, 13, 272.29998779296875, -0.0005506493203916163, -1, 5, 'DIRECTION_5M', 'v1', 'v1', 1, 0, None, None, Timestamp('2026-01-07 21:17:49.260325'), 'LABEL_20260107_211737')
2026-01-07 21:18:54 [INFO] Error: ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Arithmetic overflow error for data type tinyint, value = -1. (220) (SQLExecDirectW); [22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)')
2026-01-07 21:18:54 [INFO] ===============================================
