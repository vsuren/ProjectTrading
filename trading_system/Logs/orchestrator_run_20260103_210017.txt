2026-01-03 21:00:17 [INFO] === MASTER ORCHESTRATOR STARTED ===
2026-01-03 21:00:17 [INFO] STEP 1 SKIPPED
2026-01-03 21:00:17 [INFO] STEP 2: Merge Staging â†’ RawPrices
2026-01-03 21:00:17 [INFO] Running: ['C:\\Users\\v_sur\\AppData\\Local\\Python\\pythoncore-3.14-64\\python.exe', 'E:\\ProjectTrading\\trading_system\\ingestion\\merger.py']
2026-01-03 21:00:22 [INFO] ----- STDOUT -----
2026-01-03 21:00:22 [INFO] 2026-01-03 21:00:18 [INFO] === MERGE STARTED: Staging -> RawPrices ===
2026-01-03 21:00:18 [INFO] DB Server: suresh-trading-sql.database.windows.net, Database: TradingDB
2026-01-03 21:00:18 [INFO] Validating staging timestamps...
2026-01-03 21:00:18 [INFO] Timestamp validation passed - no invalid rows.
2026-01-03 21:00:18 [INFO] Fetching pending rows per symbol...
2026-01-03 21:00:18 [INFO] Pending rows per symbol:
2026-01-03 21:00:18 [INFO]   AAPL: 4110
2026-01-03 21:00:18 [INFO]   BCE.TO: 3977
2026-01-03 21:00:18 [INFO]   BMO.TO: 3852
2026-01-03 21:00:18 [INFO]   BNS.TO: 4088
2026-01-03 21:00:18 [INFO]   CP.TO: 3782
2026-01-03 21:00:18 [INFO]   MSFT: 4109
2026-01-03 21:00:18 [INFO]   NA.TO: 3761
2026-01-03 21:00:18 [INFO]   TD.TO: 4095
2026-01-03 21:00:18 [INFO] Beginning SQL transaction...
2026-01-03 21:00:18 [INFO] Inserting new rows into tblRawPrices...
2026-01-03 21:00:20 [INFO] Inserted 25740 new rows into tblRawPrices.
2026-01-03 21:00:21 [INFO] Marking staging rows as Exported...
2026-01-03 21:00:22 [INFO] Marked 31774 staging rows as Exported.
2026-01-03 21:00:22 [INFO] Cleaning duplicates from tblRawPrices (safety net)...
2026-01-03 21:00:22 [INFO] Duplicate cleanup removed 0 rows.
2026-01-03 21:00:22 [INFO] Committing transaction...
2026-01-03 21:00:22 [INFO] Fetching per-symbol merge summary...
2026-01-03 21:00:22 [INFO] Rows inserted in this MERGE:
2026-01-03 21:00:22 [INFO] Total rows in RawPrices after merge: 25740
2026-01-03 21:00:22 [INFO] === MERGE COMPLETED in 4.21 seconds ===
2026-01-03 21:00:22 [INFO] Completed: merger.py
2026-01-03 21:00:22 [INFO] STEP 3 SKIPPED
2026-01-03 21:00:22 [INFO] STEP 4 SKIPPED
2026-01-03 21:00:22 [INFO] === RUN SUMMARY ===
2026-01-03 21:00:22 [INFO] INGESTION:   SKIPPED
2026-01-03 21:00:22 [INFO] MERGE:       RUN
2026-01-03 21:00:22 [INFO] INDICATORS:  SKIPPED
2026-01-03 21:00:22 [INFO] FEATURES:    SKIPPED
2026-01-03 21:00:22 [INFO] DRY_RUN:     True
2026-01-03 21:00:22 [INFO] ====================
2026-01-03 21:00:22 [INFO] === MASTER ORCHESTRATOR COMPLETED ===
