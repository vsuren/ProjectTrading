2026-01-03 11:50:28 [INFO] === TEST RUN: Indicator Validation Suite ===
2026-01-03 11:50:28 [INFO] [TEST] --- Testing SMA ---
2026-01-03 11:50:28 [INFO] [TEST] SMA: FAIL
2026-01-03 11:50:28 [INFO] Cannot aggregate non-numeric type: object
2026-01-03 11:50:28 [INFO] Traceback (most recent call last):
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 371, in _prep_values
    values = ensure_float64(values)
  File "pandas/_libs/algos_common_helper.pxi", line 42, in pandas._libs.algos.ensure_float64
ValueError: could not convert string to float: 'AAPL'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 489, in _apply_columnwise
    arr = self._prep_values(arr)
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 373, in _prep_values
    raise TypeError(f"cannot handle this type -> {values.dtype}") from err
TypeError: cannot handle this type -> object

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\ProjectTrading\tests\test_indicators.py", line 88, in run_test
    out = func(df.copy(), **params)
  File "E:\ProjectTrading\trading_system\indicators\core_indicators.py", line 9, in compute_sma
    return series.rolling(window=period, min_periods=period).mean()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 2259, in mean
    return super().mean(
           ~~~~~~~~~~~~^
        numeric_only=numeric_only,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine=engine,
        ^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 1625, in mean
    return self._apply(window_func, name="mean", numeric_only=numeric_only)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 619, in _apply
    return self._apply_columnwise(homogeneous_func, name, numeric_only)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 491, in _apply_columnwise
    raise DataError(
        f"Cannot aggregate non-numeric type: {arr.dtype}"
    ) from err
pandas.errors.DataError: Cannot aggregate non-numeric type: object

2026-01-03 11:50:28 [INFO] [TEST] --- Testing EMA ---
2026-01-03 11:50:29 [INFO] [TEST] EMA: FAIL
2026-01-03 11:50:29 [INFO] Cannot aggregate non-numeric type: object
2026-01-03 11:50:29 [INFO] Traceback (most recent call last):
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 371, in _prep_values
    values = ensure_float64(values)
  File "pandas/_libs/algos_common_helper.pxi", line 42, in pandas._libs.algos.ensure_float64
ValueError: could not convert string to float: 'AAPL'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 489, in _apply_columnwise
    arr = self._prep_values(arr)
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 373, in _prep_values
    raise TypeError(f"cannot handle this type -> {values.dtype}") from err
TypeError: cannot handle this type -> object

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\ProjectTrading\tests\test_indicators.py", line 88, in run_test
    out = func(df.copy(), **params)
  File "E:\ProjectTrading\trading_system\indicators\core_indicators.py", line 12, in compute_ema
    return series.ewm(span=period, adjust=False).mean()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\ewm.py", line 565, in mean
    return self._apply(window_func, name="mean", numeric_only=numeric_only)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 619, in _apply
    return self._apply_columnwise(homogeneous_func, name, numeric_only)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 491, in _apply_columnwise
    raise DataError(
        f"Cannot aggregate non-numeric type: {arr.dtype}"
    ) from err
pandas.errors.DataError: Cannot aggregate non-numeric type: object

2026-01-03 11:50:29 [INFO] [TEST] --- Testing RSI ---
2026-01-03 11:50:29 [INFO] [TEST] RSI: FAIL
2026-01-03 11:50:29 [INFO] unsupported operand type(s) for -: 'str' and 'str'
2026-01-03 11:50:29 [INFO] Traceback (most recent call last):
  File "E:\ProjectTrading\tests\test_indicators.py", line 88, in run_test
    out = func(df.copy(), **params)
  File "E:\ProjectTrading\trading_system\indicators\core_indicators.py", line 15, in compute_rsi
    delta = series.diff()
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\frame.py", line 10071, in diff
    new_data = self._mgr.diff(n=periods)
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\internals\managers.py", line 438, in diff
    return self.apply("diff", n=n)
           ~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\internals\managers.py", line 363, in apply
    applied = getattr(b, f)(**kwargs)
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\internals\blocks.py", line 1897, in diff
    new_values = algos.diff(self.values.T, n, axis=0).T
                 ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\algorithms.py", line 1435, in diff
    out_arr[res_indexer] = op(arr[res_indexer], arr[lag_indexer])
                           ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for -: 'str' and 'str'

2026-01-03 11:50:29 [INFO] [TEST] --- Testing MACD ---
2026-01-03 11:50:29 [INFO] [TEST] MACD: FAIL
2026-01-03 11:50:29 [INFO] Cannot aggregate non-numeric type: object
2026-01-03 11:50:29 [INFO] Traceback (most recent call last):
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 371, in _prep_values
    values = ensure_float64(values)
  File "pandas/_libs/algos_common_helper.pxi", line 42, in pandas._libs.algos.ensure_float64
ValueError: could not convert string to float: 'AAPL'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 489, in _apply_columnwise
    arr = self._prep_values(arr)
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 373, in _prep_values
    raise TypeError(f"cannot handle this type -> {values.dtype}") from err
TypeError: cannot handle this type -> object

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\ProjectTrading\tests\test_indicators.py", line 88, in run_test
    out = func(df.copy(), **params)
  File "E:\ProjectTrading\trading_system\indicators\core_indicators.py", line 77, in compute_macd
    ema12 = series.ewm(span=12, adjust=False).mean()
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\ewm.py", line 565, in mean
    return self._apply(window_func, name="mean", numeric_only=numeric_only)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 619, in _apply
    return self._apply_columnwise(homogeneous_func, name, numeric_only)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\v_sur\AppData\Local\Python\pythoncore-3.14-64\Lib\site-packages\pandas\core\window\rolling.py", line 491, in _apply_columnwise
    raise DataError(
        f"Cannot aggregate non-numeric type: {arr.dtype}"
    ) from err
pandas.errors.DataError: Cannot aggregate non-numeric type: object

2026-01-03 11:50:29 [INFO] [TEST] --- Testing ATR ---
2026-01-03 11:50:29 [INFO] [TEST] ATR: PASS
2026-01-03 11:50:29 [INFO] [TEST] --- Testing SuperTrend ---
2026-01-03 11:50:29 [INFO] [TEST] SuperTrend: PASS
2026-01-03 11:50:29 [INFO] [TEST] --- Testing ADX ---
2026-01-03 11:50:29 [INFO] [TEST] ADX: PASS
2026-01-03 11:50:29 [INFO] [TEST] --- Testing Stochastic ---
2026-01-03 11:50:29 [INFO] [TEST] Stochastic: FAIL
2026-01-03 11:50:29 [INFO] Stochastic: Output length mismatch
2026-01-03 11:50:29 [INFO] Traceback (most recent call last):
  File "E:\ProjectTrading\tests\test_indicators.py", line 91, in run_test
    raise ValueError(f"{name}: Output length mismatch")
ValueError: Stochastic: Output length mismatch

2026-01-03 11:50:29 [INFO] [TEST] --- Testing BollingerBands ---
2026-01-03 11:50:29 [INFO] [TEST] BollingerBands: FAIL
2026-01-03 11:50:29 [INFO] BollingerBands: Output length mismatch
2026-01-03 11:50:29 [INFO] Traceback (most recent call last):
  File "E:\ProjectTrading\tests\test_indicators.py", line 91, in run_test
    raise ValueError(f"{name}: Output length mismatch")
ValueError: BollingerBands: Output length mismatch

2026-01-03 11:50:29 [INFO] [TEST] --- Testing CCI ---
2026-01-03 11:50:29 [INFO] [TEST] CCI: PASS
2026-01-03 11:50:29 [INFO] [TEST] --- Testing WilliamsR ---
2026-01-03 11:50:29 [INFO] [TEST] WilliamsR: PASS
2026-01-03 11:50:29 [INFO] [TEST] --- Testing VWAP ---
2026-01-03 11:50:29 [INFO] [TEST] VWAP: PASS
2026-01-03 11:50:29 [INFO] ----- TEST SUMMARY -----
2026-01-03 11:50:29 [INFO] [TEST] SMA: FAIL
2026-01-03 11:50:29 [INFO] [TEST] EMA: FAIL
2026-01-03 11:50:29 [INFO] [TEST] RSI: FAIL
2026-01-03 11:50:29 [INFO] [TEST] MACD: FAIL
2026-01-03 11:50:29 [INFO] [TEST] ATR: PASS
2026-01-03 11:50:29 [INFO] [TEST] SuperTrend: PASS
2026-01-03 11:50:29 [INFO] [TEST] ADX: PASS
2026-01-03 11:50:29 [INFO] [TEST] Stochastic: FAIL
2026-01-03 11:50:30 [INFO] [TEST] BollingerBands: FAIL
2026-01-03 11:50:30 [INFO] [TEST] CCI: PASS
2026-01-03 11:50:30 [INFO] [TEST] WilliamsR: PASS
2026-01-03 11:50:30 [INFO] [TEST] VWAP: PASS
2026-01-03 11:50:30 [INFO] === TEST RUN COMPLETE ===
